
Description of functions:

The python-based executable file includes a set of 5 functions, 4 of which process data output from the automated patch clamp device, and 1 which concatenates this processed data into a master file containing activation, inactivation, and recovery from inactivation data sorted by cell identifier. 
Descriptions of the functions are as follows:
"Activation" – Given a file with data for peaks of activation vs. voltage, normalizes to maximal conductance. Excludes cells where voltage was inadequately controlled. Fits both a single and double Boltzmann function, and plots data and saves as .png image. Bins data based on superior fit, and saves all parameters and normalized data.
“Inactivation” - Given a file with normalized data for peaks of fast inactivation vs. voltage, fits both a single and double Boltzmann function, and plots data and saves as .png image. Bins data based on superior fit, and saves all parameters and normalized data.
“Slow Inactivation” - Given a file with normalized data for peaks of fast inactivation vs. voltage, fits both a single and double Boltzmann function, and plots data and saves as .png image. Bins data based on superior fit, and saves all parameters and normalized data.
“Recovery from Inactivation” – Given a file with recovery from inactivation data (i.e. ratio of peak amplitude vs. time), fits a double exponential function. Saves images as .png, then saves all parameters and data. 
“Process” – Concatenates results from files generated by other functions. Creates a master sheet of data, mapped by identifier.

System Requirements: 
This software was developed on the Anaconda distribution of Python 3.9.12. 
Required packages are: pandas, numpy, os, glob, matplotlib, scikit.learn

Analysis Workflow:
The program is modular, meaning functions can be run independently from one another. For example, if one was interested in only fast inactivation data, they could ignore the other modules and the program will still work. The process function concatenates the outputs of these modular functions. You can select which data to include in the master file in the process function.

Step-by-step instructions

Activation
1. Create two input files, and save as .csv:
a. “Activation data” – Headers must be the unique cell identifier. The first column should be a list of test potentials (mV). Successive columns should be a list of current amplitudes corresponding to test potentials. Blank columns are okay. 
b. “Activation reversal potentials” – Headers must be the unique cell identifier. They can be in a different order than in the Activation data and extras are okay. Cell A2 should be labeled “Vrev”, and successive values in Row 2 should indicate the reversal potential of each cell. Blank columns are okay. Cell A3 should be labeled "Capacitance", and successive values in Row 3 should indicate the capacitance of each cell. Blank columns are okay.

2. Link files and choose output folder after pressing Activation from the main page.

Fast inactivation
1. Create one input file, and save as .csv:
“Inactivation data” – headers must be the unique cell identifier. The first column should be a list of test potentials (mV). Successive columns should be a list of normalized current amplitudes corresponding to peak currents following an inactivating prepulse of the given test potential. Blank columns are okay.
optional: save another file as "Inactivation Capacitances". Headers must be the unique cell identifier. The next row should be titled "Capacitance", and successive values in Row 2 should indicate the capacitance of each cell. Blank columns are okay.

2. Link files and choose output folder after pressing Inactivation from the main page.

Slow inactivation
1. Create one input file, and save as .csv:
“Slow Inactivation data” – headers must be the unique cell identifier. The first column should be a list of test potentials (mV). Successive columns should be a list of normalized current amplitudes corresponding to peak currents following an inactivating prepulse of the given test potential. Blank columns are okay.
optional: save another file as "Inactivation Capacitances". Headers must be the unique cell identifier. The next row should be titled "Capacitance", and successive values in Row 2 should indicate the capacitance of each cell. Blank columns are okay.

2. Link files and choose output folder after pressing Slow Inactivation from the main page.

Recovery from Inactivation 
1. Create one input file, and save as .csv:
“Recovery from Inactivation data” – headers must be the unique cell identifier. The first column should be a list of times between pulse 1 and pulse 2 (ms), and have the header “Time (ms)”. Successive columns should be a list of ratios that compare amplitudes of pulse 1 and pulse 2. Blank columns are okay.

Process
1. Collect output files. These files are the ones generated by the above modules. Collect both Data files as well as fit parameter files.
2. Create a capacitance file for each parameter. This data would be taken from the automated patch clamp machine, saved as a .csv, and formatted as follows:
Headers must be the unique cell identifier. They can be in a different order than in the Data and extras are okay. Cell A2 should be labeled “Cap”, and successive values in Row 2 should indicate the capacitance of each cell. Blank columns are okay.
3. Select all appropriate files after pressing "Process". The output .csv will include all selected data. 



